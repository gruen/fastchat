{"id":"ai-tui-1xk","title":"Implement uninstall subcommand","description":"Add Uninstall(opts Options) to internal/install/install.go. Steps: (1) remove ~/.local/bin/ai-tui, (2) remove ~/.local/bin/ai-tui-launch.sh, (3) prompt stdin 'Remove config and data? [y/N]' â€” if yes, remove ~/.config/ai-tui/ and ~/.local/share/ai-tui/. With --purge flag skip prompt and remove config+data. Missing files skipped silently. Print summary of removals. Tests in install_test.go.","status":"closed","priority":2,"issue_type":"feature","owner":"mg@greyworks.com","created_at":"2026-02-03T12:31:11.205689-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T12:33:21.235606-05:00","closed_at":"2026-02-03T12:33:21.235606-05:00","close_reason":"Uninstall subcommand implemented with --purge flag and tests","dependencies":[{"issue_id":"ai-tui-1xk","depends_on_id":"ai-tui-9uh","type":"blocks","created_at":"2026-02-03T12:31:16.283523-05:00","created_by":"Michael E. Gruen"}]}
{"id":"ai-tui-2js","title":"OpenAI-compatible streaming client","description":"Implement `internal/llm/openai.go` and `openai_test.go`.\n\n## OpenAIProvider struct\n- apiKey, baseURL, model, system string; maxTokens int; client *http.Client\n\n## Stream method\n- POST to `{baseURL}/chat/completions`\n- Headers: `Authorization: Bearer {apiKey}`, `content-type: application/json`\n- Body: `{\"model\": model, \"max_tokens\": maxTokens, \"stream\": true, \"messages\": [{role: \"system\", content: system}, ...rest]}`\n- Parse SSE events:\n  - `data: {\"choices\":[{\"delta\":{\"content\":\"text\"}}]}` -\u003e extract content\n  - `data: [DONE]` -\u003e signal Done\n- Use shared `ParseSSE` from stream.go\n- Works with OpenAI, Ollama, and any OpenAI-compatible API\n\n## Tests (openai_test.go)\n- httptest.Server with canned SSE responses\n- Test normal streaming\n- Test error responses\n- Test context cancellation\n- Test [DONE] signal handling","status":"closed","priority":1,"issue_type":"task","owner":"mg@greyworks.com","created_at":"2026-02-03T10:15:34.577256-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T10:31:11.43771-05:00","closed_at":"2026-02-03T10:31:11.43771-05:00","close_reason":"Closed","labels":["phase-2"],"dependencies":[{"issue_id":"ai-tui-2js","depends_on_id":"ai-tui-7ix","type":"blocks","created_at":"2026-02-03T10:15:34.577945-05:00","created_by":"Michael E. Gruen"}]}
{"id":"ai-tui-2lq","title":"Simplify Makefile to use self-install","description":"Update Makefile install target to: build then ./ai-tui install. Add uninstall target: ./ai-tui uninstall --purge. Keep build, test, clean targets as-is.","status":"closed","priority":3,"issue_type":"chore","owner":"mg@greyworks.com","created_at":"2026-02-03T12:31:12.510173-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T12:33:40.291416-05:00","closed_at":"2026-02-03T12:33:40.291416-05:00","close_reason":"Makefile install/uninstall now delegates to binary subcommands","dependencies":[{"issue_id":"ai-tui-2lq","depends_on_id":"ai-tui-1xk","type":"blocks","created_at":"2026-02-03T12:31:16.33974-05:00","created_by":"Michael E. Gruen"}]}
{"id":"ai-tui-3as","title":"Claude streaming client","description":"Implement `internal/llm/claude.go` and `claude_test.go`.\n\n## ClaudeProvider struct\n- apiKey, model, system string; maxTokens int; client *http.Client\n\n## Stream method\n- POST to `{baseURL}/v1/messages`\n- Headers: `x-api-key`, `anthropic-version: 2023-06-01`, `content-type: application/json`\n- Body: `{\"model\": model, \"max_tokens\": maxTokens, \"stream\": true, \"system\": system, \"messages\": [...]}`\n- Parse SSE events:\n  - `content_block_delta` -\u003e extract `delta.text` from JSON\n  - `message_stop` -\u003e signal Done\n  - `error` -\u003e extract error message\n- Use shared `ParseSSE` from stream.go\n\n## Tests (claude_test.go)\n- httptest.Server that serves canned SSE responses\n- Test normal streaming (multiple chunks then stop)\n- Test error response (400, 401, 429)\n- Test context cancellation mid-stream\n- Test empty response","status":"closed","priority":1,"issue_type":"task","owner":"mg@greyworks.com","created_at":"2026-02-03T10:15:30.432562-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T10:31:55.861546-05:00","closed_at":"2026-02-03T10:31:55.861546-05:00","close_reason":"Closed","labels":["phase-2"],"dependencies":[{"issue_id":"ai-tui-3as","depends_on_id":"ai-tui-7ix","type":"blocks","created_at":"2026-02-03T10:15:30.433329-05:00","created_by":"Michael E. Gruen"}]}
{"id":"ai-tui-4aj","title":"History view model","description":"Implement `internal/tui/history/model.go`, `model_test.go`, `commands.go`.\n\n## Model struct\n- list (bubbles list), sessions []db.Session, preview string\n- db *db.DB, notesDir string, showArchived bool, width/height int\n\n## Custom messages\n- SessionsLoadedMsg{Sessions}, PreviewLoadedMsg{Content}\n- SessionArchivedMsg{SessionID}, SessionExportedMsg{Path}\n- ResumeSessionMsg{Session, Messages} (handled by root model)\n\n## List item display\n- Title: session.Title (or truncated first message if empty)\n- Description: provider | model | timestamp | message count\n- FilterValue: title + first message content\n\n## Update flows\n- Init: return loadSessionsCmd\n- j/k or arrows: navigate (bubbles list)\n- Enter or l: load full session + messages, emit ResumeSessionMsg\n- s: export session to markdown, show confirmation inline\n- d: archive session, remove from list, show confirmation\n- a: toggle showArchived, reload list\n- Ctrl+N: new compose signal to parent\n- Ctrl+D: quit\n\n## View\n- Session list with help bar at bottom:\n  `enter: open | s: save | d: archive | a: show archived | ctrl+n: new | ctrl+d: quit`\n\n## Commands (commands.go)\n- loadSessionsCmd, loadPreviewCmd, archiveSessionCmd, resumeSessionCmd, exportSessionCmd\n\n## Tests (model_test.go)\n- Test list population, archive removes from list, showArchived toggle, item formatting","status":"closed","priority":2,"issue_type":"task","owner":"mg@greyworks.com","created_at":"2026-02-03T10:16:18.045253-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T10:42:15.584127-05:00","closed_at":"2026-02-03T10:42:15.584127-05:00","close_reason":"Closed","labels":["phase-4"],"dependencies":[{"issue_id":"ai-tui-4aj","depends_on_id":"ai-tui-4r9","type":"blocks","created_at":"2026-02-03T10:16:18.045964-05:00","created_by":"Michael E. Gruen"},{"issue_id":"ai-tui-4aj","depends_on_id":"ai-tui-ciq","type":"blocks","created_at":"2026-02-03T10:16:18.046653-05:00","created_by":"Michael E. Gruen"}]}
{"id":"ai-tui-4r9","title":"Root TUI model and key bindings","description":"Implement `internal/tui/app.go`, `app_test.go`, `keys.go`, `styles.go`.\n\n## AppModel (app.go)\n```go\ntype View int\nconst (ComposeView View = iota; HistoryView)\ntype AppModel struct {\n    activeView View; compose compose.Model; history history.Model\n    cfg *config.Config; db *db.DB; providers map[string]llm.Provider\n    width, height int; quitting bool; program *tea.Program\n}\n```\n\n## Init: return `tea.WindowSize`\n## Update:\n- `tea.WindowSizeMsg` -\u003e propagate to children\n- `tea.KeyMsg` global keys: `ctrl+h` = history, `ctrl+n` = new compose, `ctrl+d` = quit\n- Delegate all other keys to active child\n- Handle child messages: `ResumeSessionMsg` switches to compose with loaded session\n\n## View: render active child + status bar (provider, model, session info)\n\n## Key bindings (keys.go)\n- Define KeyMap structs for global, compose, and history contexts\n- Use `bubbles/key` for help integration\n\n## Styles (styles.go)\n- Lipgloss styles for: status bar, help bar, user message, assistant message, error, title\n- Muted colors for help bar text, accent for active elements\n\n## Tests (app_test.go)\n- Test view switching via key messages\n- Test window size propagation\n- Test ctrl+d sets quitting","status":"closed","priority":1,"issue_type":"task","owner":"mg@greyworks.com","created_at":"2026-02-03T10:15:44.215177-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T10:32:12.681968-05:00","closed_at":"2026-02-03T10:32:12.681968-05:00","close_reason":"Closed","labels":["phase-3"],"dependencies":[{"issue_id":"ai-tui-4r9","depends_on_id":"ai-tui-7hj","type":"blocks","created_at":"2026-02-03T10:15:44.21587-05:00","created_by":"Michael E. Gruen"},{"issue_id":"ai-tui-4r9","depends_on_id":"ai-tui-loz","type":"blocks","created_at":"2026-02-03T10:15:44.216542-05:00","created_by":"Michael E. Gruen"}]}
{"id":"ai-tui-66n","title":"Hyprland launcher and install","description":"Create `scripts/ai-tui-launch.sh` and finalize Makefile + README.\n\n## Launcher script (scripts/ai-tui-launch.sh)\n```bash\n#\\!/usr/bin/env bash\nTERMINAL=\"${AI_TUI_TERMINAL:-foot}\"\nCLASS=\"ai-tui-float\"\ncase \"$TERMINAL\" in\n    foot) exec foot --app-id=\"$CLASS\" -e ai-tui ;;\n    kitty) exec kitty --class=\"$CLASS\" -e ai-tui ;;\n    alacritty) exec alacritty --class \"$CLASS\",\"$CLASS\" -e ai-tui ;;\n    *) echo \"Unsupported terminal: $TERMINAL\" \u003e\u00262; exit 1 ;;\nesac\n```\n\n## Hyprland config (document in README)\n```\nwindowrulev2 = float, class:^(ai-tui-float)$\nwindowrulev2 = size 60% 70%, class:^(ai-tui-float)$\nwindowrulev2 = center, class:^(ai-tui-float)$\nwindowrulev2 = dimaround, class:^(ai-tui-float)$\nbind = $mainMod, SPACE, exec, ~/.local/bin/ai-tui-launch.sh\n```\n\n## Makefile targets\n- build: go build with ldflags version\n- install: build + install binary to ~/.local/bin/ + launcher script + create config dir + copy example config if not exists\n- test: go test ./...\n- clean: rm binary\n\n## Install locations\n- Binary: ~/.local/bin/ai-tui\n- Launcher: ~/.local/bin/ai-tui-launch.sh\n- Config: ~/.config/ai-tui/config.toml\n- DB: ~/.local/share/ai-tui/ai-tui.db (auto-created)\n- Exports: ~/ai-notes/ (configurable)","status":"closed","priority":2,"issue_type":"task","owner":"mg@greyworks.com","created_at":"2026-02-03T10:16:45.230214-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T10:46:06.288731-05:00","closed_at":"2026-02-03T10:46:06.288731-05:00","close_reason":"Launcher script created with foot/kitty/alacritty support. Makefile already had install targets.","labels":["phase-6"],"dependencies":[{"issue_id":"ai-tui-66n","depends_on_id":"ai-tui-gu2","type":"blocks","created_at":"2026-02-03T10:16:52.323388-05:00","created_by":"Michael E. Gruen"}]}
{"id":"ai-tui-7hj","title":"Initialize Go module and project skeleton","description":"Create the foundational project structure for ai-tui.\n\n## Tasks\n- `go mod init github.com/mg/ai-tui` with Go 1.25+\n- Create directory structure: `internal/config/`, `internal/db/`, `internal/llm/`, `internal/tui/compose/`, `internal/tui/history/`, `internal/export/`, `scripts/`\n- Create minimal `main.go` that parses flags (`--config`, `--version`) and exits\n- Create `config.example.toml` with full schema: providers (claude, openai, local), storage (db_path, notes_dir), ui (show_tokens, max_width)\n- Create `Makefile` with build, install, clean, test targets\n- VERSION via `git describe` in ldflags\n\n## Acceptance\n- `go build ./...` succeeds\n- Directory structure exists\n- `config.example.toml` is valid TOML","status":"closed","priority":0,"issue_type":"task","owner":"mg@greyworks.com","created_at":"2026-02-03T10:14:59.667684-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T10:22:59.801637-05:00","closed_at":"2026-02-03T10:22:59.801637-05:00","close_reason":"Closed","labels":["phase-1"]}
{"id":"ai-tui-7ix","title":"LLM provider interface and SSE parser","description":"Implement `internal/llm/provider.go` and `stream.go`.\n\n## Provider interface (provider.go)\n```go\ntype StreamChunk struct { Content string; Done bool; Error error }\ntype ChatMessage struct { Role string; Content string }\ntype Provider interface {\n    Stream(ctx context.Context, messages []ChatMessage) (\u003c-chan StreamChunk, error)\n    Name() string\n}\nfunc BuildProviders(cfg map[string]config.Provider) map[string]Provider\n```\n- BuildProviders inspects BaseURL to pick Claude vs OpenAI client\n- Claude if base_url contains \"anthropic.com\", OpenAI otherwise\n\n## SSE parser (stream.go)\n```go\nfunc ParseSSE(ctx context.Context, body io.ReadCloser, onData func(data []byte) (StreamChunk, bool)) \u003c-chan StreamChunk\n```\n- Reads line-by-line from body\n- Lines starting with `data: ` are passed to onData callback\n- Respects context cancellation\n- Closes body when done\n- Channel closed when stream ends or context cancelled","status":"closed","priority":0,"issue_type":"task","owner":"mg@greyworks.com","created_at":"2026-02-03T10:15:20.345944-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T10:27:38.080762-05:00","closed_at":"2026-02-03T10:27:38.080762-05:00","close_reason":"Closed","labels":["phase-1"]}
{"id":"ai-tui-9ng","title":"Markdown export","description":"Implement `internal/export/markdown.go` and `markdown_test.go`.\n\n## Function\n```go\nfunc ToMarkdown(session db.Session, messages []db.Message, dir string) (string, error)\n```\n\n## Output format\nFile: `{dir}/{date}-{sanitized-title}.md`\n\n```markdown\n# {session.Title}\n\n**Provider:** {provider} | **Model:** {model}\n**Date:** {created_at formatted}\n\n---\n\n**You:**\n{user message content}\n\n**Assistant:**\n{assistant message content}\n\n---\n```\n\n## Behavior\n- Create dir if not exists (`os.MkdirAll`)\n- Sanitize title for filename: lowercase, replace spaces with hyphens, remove special chars, max 50 chars\n- Date prefix as YYYY-MM-DD\n- If file exists, append -1, -2 etc.\n- Return full path of created file\n\n## Tests (markdown_test.go)\n- Test output format matches expected\n- Test filename sanitization\n- Test directory creation\n- Test duplicate filename handling","status":"closed","priority":2,"issue_type":"task","owner":"mg@greyworks.com","created_at":"2026-02-03T10:16:24.210595-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T10:32:25.68108-05:00","closed_at":"2026-02-03T10:32:25.68108-05:00","close_reason":"Closed","labels":["phase-5"],"dependencies":[{"issue_id":"ai-tui-9ng","depends_on_id":"ai-tui-ciq","type":"blocks","created_at":"2026-02-03T10:16:24.21127-05:00","created_by":"Michael E. Gruen"}]}
{"id":"ai-tui-9uh","title":"Implement install subcommand","description":"Create internal/install/install.go with Install(opts Options) function. Options struct has BinDir, ConfigDir, DataDir, Config []byte, Launcher []byte, Self string. Steps: (1) copy self to ~/.local/bin/ai-tui (skip if already there), (2) write embedded launcher to ~/.local/bin/ai-tui-launch.sh mode 0755, (3) mkdir ~/.config/ai-tui/, (4) write embedded config to ~/.config/ai-tui/config.toml only if not exists mode 0644, (5) print summary + Hyprland config snippet. Each step prints checkmark. Tests in internal/install/install_test.go using temp dirs via Options overrides.","status":"closed","priority":2,"issue_type":"feature","owner":"mg@greyworks.com","created_at":"2026-02-03T12:31:08.754656-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T12:33:21.19646-05:00","closed_at":"2026-02-03T12:33:21.19646-05:00","close_reason":"Install subcommand implemented with tests","dependencies":[{"issue_id":"ai-tui-9uh","depends_on_id":"ai-tui-n1t","type":"blocks","created_at":"2026-02-03T12:31:16.229007-05:00","created_by":"Michael E. Gruen"}]}
{"id":"ai-tui-ciq","title":"SQLite database layer","description":"Implement `internal/db/db.go`, `models.go`, `queries.go`, `queries_test.go`.\n\n## Schema\n```sql\nCREATE TABLE sessions (id TEXT PRIMARY KEY, title TEXT NOT NULL DEFAULT '', provider TEXT NOT NULL, model TEXT NOT NULL, created_at TEXT NOT NULL, updated_at TEXT NOT NULL, archived INTEGER NOT NULL DEFAULT 0);\nCREATE TABLE messages (id INTEGER PRIMARY KEY AUTOINCREMENT, session_id TEXT NOT NULL REFERENCES sessions(id), role TEXT NOT NULL, content TEXT NOT NULL, created_at TEXT NOT NULL, tokens INTEGER NOT NULL DEFAULT 0);\nCREATE INDEX idx_messages_session ON messages(session_id);\nCREATE INDEX idx_sessions_created ON sessions(created_at DESC);\n```\n\n## Go structs (models.go)\n- Session: ID, Title, Provider, Model string; CreatedAt, UpdatedAt time.Time; Archived bool\n- Message: ID int64; SessionID, Role, Content string; CreatedAt time.Time; Tokens int\n\n## DB wrapper (db.go)\n- `Open(path string) (*DB, error)` - opens SQLite, enables WAL mode, runs migrations\n- `Close()`\n- Use `modernc.org/sqlite` (pure Go, no CGo)\n- Auto-create parent directories for db file\n\n## Queries (queries.go)\n- CreateSession, GetSession, ListSessions(includeArchived bool), UpdateSessionTitle, ArchiveSession, UnarchiveSession, AddMessage, GetSessionMessages, DeleteSession\n\n## Tests (queries_test.go)\n- Use `\":memory:\"` SQLite for all tests\n- Test full CRUD cycle for sessions and messages\n- Test ListSessions filtering archived\n- Test ordering","status":"closed","priority":0,"issue_type":"task","owner":"mg@greyworks.com","created_at":"2026-02-03T10:15:14.679717-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T10:26:50.576561-05:00","closed_at":"2026-02-03T10:26:50.576561-05:00","close_reason":"Closed","labels":["phase-1"]}
{"id":"ai-tui-gu2","title":"Wire main.go entry point","description":"Complete `main.go` to wire everything together.\n\n## Flow\n1. Parse flags: `--config` (default `~/.config/ai-tui/config.toml`), `--version`\n2. Load config via `config.Load()`\n3. Open DB via `db.Open(cfg.Storage.DBPath)`\n4. Build providers via `llm.BuildProviders(cfg.Providers)`\n5. Create AppModel via `tui.NewAppModel(cfg, db, providers)`\n6. Create `tea.Program` with `tea.WithAltScreen()`\n7. Call `model.SetProgram(p)`\n8. `p.Run()`\n9. `defer db.Close()`\n\n## Error handling\n- Config not found: create `~/.config/ai-tui/` dir, copy config.example.toml, print message and exit\n- Config invalid: print validation errors and exit\n- DB open failure: print error and exit\n- No providers configured: print error and exit\n\n## Version\n- `var version = \"dev\"` set via ldflags at build time\n- `--version` prints `ai-tui {version}` and exits","status":"closed","priority":2,"issue_type":"task","owner":"mg@greyworks.com","created_at":"2026-02-03T10:16:34.704951-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T10:45:21.589182-05:00","closed_at":"2026-02-03T10:45:21.589182-05:00","close_reason":"main.go wired with config, DB, providers, TUI. All tests pass.","labels":["phase-6"],"dependencies":[{"issue_id":"ai-tui-gu2","depends_on_id":"ai-tui-3as","type":"blocks","created_at":"2026-02-03T10:16:34.705718-05:00","created_by":"Michael E. Gruen"},{"issue_id":"ai-tui-gu2","depends_on_id":"ai-tui-2js","type":"blocks","created_at":"2026-02-03T10:16:34.70644-05:00","created_by":"Michael E. Gruen"},{"issue_id":"ai-tui-gu2","depends_on_id":"ai-tui-w3l","type":"blocks","created_at":"2026-02-03T10:16:34.707002-05:00","created_by":"Michael E. Gruen"},{"issue_id":"ai-tui-gu2","depends_on_id":"ai-tui-4aj","type":"blocks","created_at":"2026-02-03T10:16:34.707541-05:00","created_by":"Michael E. Gruen"},{"issue_id":"ai-tui-gu2","depends_on_id":"ai-tui-9ng","type":"blocks","created_at":"2026-02-03T10:16:34.708042-05:00","created_by":"Michael E. Gruen"}]}
{"id":"ai-tui-loz","title":"Config loader with env var expansion","description":"Implement `internal/config/config.go` and `config_test.go`.\n\n## Structs\n- `Config`: DefaultProvider string, Providers map[string]Provider, Storage, UI\n- `Provider`: APIKey, BaseURL, Model, SystemPrompt string, MaxTokens int\n- `Storage`: DBPath, NotesDir string\n- `UI`: ShowTokens bool, MaxWidth int\n\n## Behavior\n- `Load(path string) (*Config, error)` reads TOML file\n- Expand `~` in paths via `os.UserHomeDir`\n- Expand `$ENV_VAR` in APIKey fields via `os.Getenv`\n- `DefaultPath()` returns `~/.config/ai-tui/config.toml`\n- Validate: at least one provider, default_provider exists in providers map\n- Apply defaults: MaxTokens=4096, MaxWidth=100, DBPath=~/.local/share/ai-tui/ai-tui.db, NotesDir=~/ai-notes/\n\n## Tests (config_test.go)\n- Test TOML parsing with valid config\n- Test env var expansion (set test env vars)\n- Test `~` expansion\n- Test validation errors (missing provider, bad default)\n- Test default values applied for missing optional fields","status":"closed","priority":0,"issue_type":"task","owner":"mg@greyworks.com","created_at":"2026-02-03T10:15:06.806323-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T10:25:07.168567-05:00","closed_at":"2026-02-03T10:25:07.168567-05:00","close_reason":"Closed","labels":["phase-1"]}
{"id":"ai-tui-n1t","title":"Add go:embed and subcommand routing in main.go","description":"Embed config.example.toml and scripts/ai-tui-launch.sh in main.go using go:embed. Add subcommand routing before flag parsing: check os.Args[1] for 'install', 'uninstall', 'version', or default to TUI. Keep --config flag for TUI path.","status":"closed","priority":2,"issue_type":"task","owner":"mg@greyworks.com","created_at":"2026-02-03T12:31:05.527859-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T12:33:21.156501-05:00","closed_at":"2026-02-03T12:33:21.156501-05:00","close_reason":"go:embed and subcommand routing added to main.go"}
{"id":"ai-tui-w3l","title":"Compose view model","description":"Implement `internal/tui/compose/model.go`, `model_test.go`, `commands.go`.\n\n## Model struct\n- textarea (bubbles), viewport (bubbles), messages []DisplayMessage\n- streaming bool, streamBuf strings.Builder\n- session *db.Session, db *db.DB, provider llm.Provider, program *tea.Program\n- cancelFn context.CancelFunc, err error, width/height int\n\n## Custom messages\n- StreamChunkMsg{Content, Done}\n- StreamErrMsg{Err}\n- StreamStartedMsg{Cancel}\n- SessionCreatedMsg{Session}\n\n## Update flows\n1. **Enter** (not streaming): append user msg, clear textarea, set streaming=true, return streamCmd\n2. **StreamChunkMsg**: append to streamBuf; if Done: streaming=false, append full msg, reset buf\n3. **StreamErrMsg**: set err, streaming=false\n4. **Esc or Ctrl+C** (while streaming): call cancelFn(), save partial response, streaming=false\n5. **Ctrl+D**: quit signal to parent\n\n## View rendering\n- Viewport: conversation history. User msgs with \"You:\" prefix. Assistant msgs rendered via glamour.\n- During streaming: append streamBuf to viewport, show spinner instead of textarea\n- Help bar at bottom: `enter: send | ctrl+h: history | ctrl+d: quit` (normal) or `esc: stop | ctrl+d: quit` (streaming)\n\n## Commands (commands.go)\n- `streamCmd`: creates context, calls provider.Stream(), goroutine reads channel and p.Send()s chunks\n- `saveMessageCmd`: persists message to DB\n- `createSessionCmd`: creates session in DB with UUID\n- Auto-generate title from first 60 chars of first user message\n\n## Tests (model_test.go)\n- Test message append on Enter\n- Test streaming state transitions\n- Test Esc cancels streaming\n- Test help bar content changes with state","status":"closed","priority":1,"issue_type":"task","owner":"mg@greyworks.com","created_at":"2026-02-03T10:15:58.228943-05:00","created_by":"Michael E. Gruen","updated_at":"2026-02-03T10:40:10.089691-05:00","closed_at":"2026-02-03T10:40:10.089691-05:00","close_reason":"Closed","labels":["phase-3"],"dependencies":[{"issue_id":"ai-tui-w3l","depends_on_id":"ai-tui-4r9","type":"blocks","created_at":"2026-02-03T10:16:07.213724-05:00","created_by":"Michael E. Gruen"}]}
